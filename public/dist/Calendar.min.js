function delete_event(){event_obj.id?$.ajax({type:"POST",url:base_url+"/delete_event",data:"id="+event_id,success:function(e){event_id&&(console.log("saved event deleted Successfully"),$(calendar_container).fullCalendar("removeEvents",event_id),$("#edit_event_modal").modal("hide"))},error:function(){alert("update failed!")}}):(console.log("unsaved event deleted Successfully"),$(calendar_container).fullCalendar("removeEvents",event_id),$("#edit_event_modal").modal("hide"))}function update_event_title(){event_obj.title=$('#edit_event_modal input[type="text"]').val(),event_obj.id?$.ajax({type:"POST",url:base_url+"/update_event_title",data:{id:event_obj.id,title:event_obj.title},success:function(e){console.log("saved event title updated Successfully"),$(calendar_container).fullCalendar("updateEvent",event_obj),$("#edit_event_modal").modal("hide")},error:function(){alert("update failed!")}}):(console.log("unsaved event title updated Successfully"),$(calendar_container).fullCalendar("updateEvent",event_obj),$("#edit_event_modal").modal("hide"))}function add_event(){var e=$('#add_event_modal input[type="text"]').val();if(e){var t=event_start.format(),a=event_end.format();$.ajax({url:base_url+"/add_event",data:"title="+e+"&start="+t+"&end="+a,type:"POST",success:function(n){id=n,id?$(calendar_container).fullCalendar("renderEvent",{title:e,start:t,end:a,id:id}):$(calendar_container).fullCalendar("renderEvent",{title:e,start:t,end:a},!0),$("#add_event_modal").modal("hide")},error:function(){alert("update failed!")}})}$(calendar_container).fullCalendar("unselect")}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){function t(t,d,o,r,i){function s(a,n){var d=n||[{message:a}],l=window.console,o=l?l.warn||l.log:null;(t.googleCalendarError||e.noop).apply(i,d),(i.options.googleCalendarError||e.noop).apply(i,d),o&&o.apply(l,[a].concat(n||[]))}var c,u,v=n+"/"+encodeURIComponent(t.googleCalendarId)+"/events?callback=?",_=t.googleCalendarApiKey||i.options.googleCalendarApiKey,p=t.success;return _?(d.hasZone()||(d=d.clone().utc().add(-1,"day")),o.hasZone()||(o=o.clone().utc().add(1,"day")),r&&"local"!=r&&(u=r.replace(" ","_")),c=e.extend({},t.data||{},{key:_,timeMin:d.format(),timeMax:o.format(),timeZone:u,singleEvents:!0,maxResults:9999}),e.extend({},t,{googleCalendarId:null,url:v,data:c,startParam:!1,endParam:!1,timezoneParam:!1,success:function(t){var n,d,o=[];if(t.error)s("Google Calendar API: "+t.error.message,t.error.errors);else if(t.items&&(e.each(t.items,function(e,t){var n=t.htmlLink;u&&(n=a(n,"ctz="+u)),o.push({id:t.id,title:t.summary,start:t.start.dateTime||t.start.date,end:t.end.dateTime||t.end.date,url:n,location:t.location,description:t.description})}),n=[o].concat(Array.prototype.slice.call(arguments,1)),d=l(p,this,n),e.isArray(d)))return d;return o}})):(s("Specify a googleCalendarApiKey. See http://fullcalendar.io/docs/google_calendar/"),{})}function a(e,t){return e.replace(/(\?.*?)?(#|$)/,function(e,a,n){return(a?a+"&":"?")+t+n})}var n="https://www.googleapis.com/calendar/v3/calendars",d=e.fullCalendar,l=d.applyAll;d.sourceNormalizers.push(function(e){var t,a=e.googleCalendarId,n=e.url;!a&&n&&(/^[^\/]+@([^\/\.]+\.)*(google|googlemail|gmail)\.com$/.test(n)?a=n:((t=/^https:\/\/www.googleapis.com\/calendar\/v3\/calendars\/([^\/]*)/.exec(n))||(t=/^https?:\/\/www.google.com\/calendar\/feeds\/([^\/]*)/.exec(n)))&&(a=decodeURIComponent(t[1])),a&&(e.googleCalendarId=a)),a&&(null===e.editable&&(e.editable=!1),e.url=a)}),d.sourceFetchers.push(function(e,a,n,d){return e.googleCalendarId?t(e,a,n,d,this):void 0})}),$(document).ready(function(){calendar_container="#Calendar",$(calendar_container).fullCalendar({header:{right:"prev,next today",left:"title",center:""},eventBackgroundColor:"#E297F5",eventTextColor:"black",eventBorderColor:"transparent",height:"auto",contentHeight:"auto",handleWindowResize:!0,fixedWeekCount:!1,editable:!0,selectable:!0,selectHelper:!0,select:function(e,t){event_start=e,event_end=t,$("#add_event_button").addClass("disabled").attr("disabled","disabled"),$('#add_event_modal input[type="text"]').val(""),$('#add_event_modal input[type="text"]').keyup(function(){""!==$(this).val()?$("#add_event_button").removeClass("disabled").removeAttr("disabled"):$("#add_event_button").addClass("disabled").attr("disabled","disabled")}),$("#add_event_modal").modal("show")},eventDrop:function(e,t){var a=e.start.format(),n=e.end.format();e.id?$.ajax({url:base_url+"/update_event",data:"title="+e.title+"&start="+a+"&end="+n+"&id="+e.id,type:"POST",success:function(e){console.log("Updated Successfully")},error:function(){alert("update failed!")}}):console.log("unsaved event updated successfully")},eventResize:function(e){var t=e.start.format(),a=e.end.format();e.id?$.ajax({url:base_url+"/update_event",data:"title="+e.title+"&start="+t+"&end="+a+"&id="+e.id,type:"POST",success:function(e){console.log("saved event updated Successfully")},error:function(){alert("update failed!")}}):console.log("unsaved event updated successfully")},googleCalendarApiKey:"AIzaSyBccjc1pHRSKUFe7yM8ltVbYPy_wvXVgWE",eventLimit:2,eventSources:[{url:base_url+"/show_events",error:function(){$("#script-warning").show()}},{googleCalendarId:"en.indian#holiday@group.v.calendar.google.com",className:"gcal-event",backgroundColor:"#ECE2EF",borderColor:"transparent",textColor:"black"}],eventClick:function(e,t,a){return event_id=e.id?e.id:e._id,event_obj=e,$("#save_event_button").addClass("disabled").attr("disabled","disabled"),$('#edit_event_modal input[type="text"]').val(e.title),$('#edit_event_modal input[type="text"]').keyup(function(){""!==$(this).val()?$("#save_event_button").removeClass("disabled").removeAttr("disabled"):$("#save_event_button").addClass("disabled").attr("disabled","disabled")}),e.source&&e.source.googleCalendarId?(window.open("https://www.google.co.in/search?q="+encodeURI(e.title)),!1):void $("#edit_event_modal").modal("show")}}),$("#delete_event_button").unbind("click").on("click",function(){delete_event()}),$("#save_event_button").unbind("click").on("click",function(){update_event_title()}),$("#add_event_button").unbind("click").on("click",function(){add_event()}),$("#add_event_modal input[type=text]").keypress(function(e){var t=e.keyCode?e.keyCode:e.which;return"13"==t?(add_event(),!1):void 0})});var event_id,event_obj,event_start,event_end;