function isEmpty(e){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}function getChannelWithNoID(e){$.ajax({type:"GET",url:base_url+"/get_channel_id",data:{channel_name:e},success:function(n){getChannel(e,n[0].id)},error:function(){console.log("error fetching channel id!")}})}function addChannel(e,n){var a,l;"load"===n?(a=e.channel_name,l=e.id,$("[title='"+a+"']").prop("disabled",!0),$("[title='"+a+"']").css("opacity",.4),$(tv_schedule_container).append("<div class='channel_outer well'><h3><b> "+a+"</b><span><button  class='remove_button btn btn-xs btn-default pull-right' onclick='remove_channel(\""+a+"\")'><i class='fa fa-times'></i></button></span></h3><table class='table '><tbody id='"+a.replace(/\s/g,"_")+"' class='channels'></tbody></table></div>"),getChannel(a,l)):(a=e,$("[title='"+a+"']").prop("disabled",!0),$("[title='"+a+"']").css("opacity",.4),$(tv_schedule_container).prepend("<div class='channel_outer well'><h3><b> "+a+"</b><span><button  class='remove_button btn btn-xs btn-default pull-right' onclick='remove_channel(\""+a+"\")'><i class='fa fa-times'></i></button></span></h3><table class='table '><tbody id='"+a.replace(/\s/g,"_")+"' class='channels'></tbody></table ></div>"),save_channel(a),getChannelWithNoID(a))}function getChannel(e,n){var a="http://tv.burrp.com/UpcomingSchedules.php?ID="+n+"&channelName="+e,l='select * from html where url="'+encodeURI(a)+'"';$.ajax({url:"https://query.yahooapis.com/v1/public/yql",dataType:"json",data:{q:l,format:"json"},success:function(n){var a=n.query.results.body;console.log("fetched "+e+" channel info");var l=a.content.trim().replace(/\s\s+/g," ").split(" "),t=a.a,c="",o=a.p.a.href;t.forEach(function(n,a){c=0===a?"<sup class='now'>Playing Now</sup>":"",$("#"+e.replace(/\s/g,"_")).append("<tr><th>"+l[a]+"</th><td><a href = '"+n.href+"' target = 'blank' ><strong>"+n.strong+"</strong></a>"+c+"</td></tr>")}),$("#"+e.replace(/\s/g,"_")).append("<tr><th></th><td align='right'><p class='more'><a href="+o+" target='blank'>Full schedule</a></p></td></tr>")},error:function(){console.log("error fetching "+e)}})}function save_channel(e){$.ajax({url:base_url+"/add_channel",type:"POST",data:"channel="+e,success:function(n){console.log(e+" channel saved successfully")},error:function(){console.log("error saving "+e+" channel")}})}function remove_channel(e){$("#"+e.replace(/\s/g,"_")).parents(".channel_outer").remove(),$("[title='"+e+"']").prop("disabled",!1),$("[title='"+e+"']").css("opacity",1),$.ajax({url:base_url+"/remove_channel",type:"POST",data:"channel="+e,success:function(n){console.log(e+" removed successfully")},error:function(){console.log("error removing "+e+" channel")}}),console.log(e+" deleted successfully");var n=[];$(".channels").each(function(e,a){n[e]=$(".channels").eq(e).attr("id")}),0===n.length&&save_channel("void_channel")}$(document).ready(function(){0===document.getElementsByClassName("channel_outer").length&&$.ajax({type:"GET",url:base_url+"/get_channels",success:function(e){console.log("retrieved channels Successfully",e),isEmpty(e)||e.forEach(function(e,n){"void_channel"!==e.channel_name&&addChannel(e,"load")})},error:function(){console.log("error fetching channels!")}}),$(".channel_outer").each(function(e,n){var a=$(this).find(".channels").attr("id");$("[title='"+a.replace(/_/g," ")+"']").prop("disabled",!0),$("[title='"+a.replace(/_/g," ")+"']").css("opacity",.4)}),$("#tv_schedule_modal").on("shown.bs.modal",function(){$("#tv_schedule_modal img.lazy").lazyload({skip_invisible:!0,container:$("#tv_schedule_modal")})}),$("#add_channel_button").unbind("click").on("click",function(){$("#tv_schedule_modal").modal("show")}),$(".channelLogoBox").unbind("click").on("click",function(){addChannel(this.title,"add")})});var tv_schedule_container="#TV_Schedule";